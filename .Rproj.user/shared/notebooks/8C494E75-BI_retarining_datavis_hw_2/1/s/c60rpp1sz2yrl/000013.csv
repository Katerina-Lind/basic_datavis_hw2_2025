"0",""
"0","set.seed(2025)"
"0",""
"0","colours_ <- colours()"
"0","res_colours <- colours_[colours_ |> str_detect(""grey|gray|black|white"", negate = TRUE)]|>  "
"0","  sample(size = 36)"
"0",""
"0","df_scores <- hogwarts %>% clean_names() %>% select(result) %>% drop_na()"
"0",""
"0","make_hist <- function(col, data = df_scores, bins = 30) {"
"0","ggplot(data, aes(x = result)) +"
"0","geom_histogram(bins = bins, fill = col, color = ""white"","
"0","linewidth = 0.4, boundary = 0) +"
"0","geom_vline(xintercept = mean(data$result, na.rm = TRUE),"
"0","linetype = ""dashed"", color = ""black"", linewidth = 0.6) +"
"0","ggtitle(col) +"
"0","labs(x = ""Total score"", y = ""Count"") +"
"0","theme_minimal(base_size = 10) +"
"0","theme(plot.title = element_text(size = 9, hjust = 0.5, face = ""bold""),"
"0","axis.title = element_text(size = 9),"
"0","axis.text = element_text(size = 7),"
"0","panel.grid.minor = element_blank(),"
"0","plot.margin = margin(5, 5, 5, 5))"
"0","}"
"0",""
"0","plots <- purrr::map(res_colours, make_hist)"
"0",""
"0","wrap_plots(plots, ncol = 3) +"
"0","plot_annotation("
"0","title = ""Distribution of Yearly Total Scores (36 color variants)"","
"0","subtitle = ""Each histogram uses a color from res_colours"","
"0","theme = theme(plot.title = element_text(hjust = 0.5, size = 16, face = ""bold""),"
"0","plot.subtitle = element_text(hjust = 0.5, size = 11))"
"0",")"
