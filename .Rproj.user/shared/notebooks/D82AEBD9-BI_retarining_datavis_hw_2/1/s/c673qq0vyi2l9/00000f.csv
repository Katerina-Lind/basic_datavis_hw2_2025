"0",""
"0","df_weekly <- hogwarts %>%"
"0","  clean_names() %>%"
"0","  pivot_longer(starts_with(""week_""), names_to = ""week"", values_to = ""score"") %>%"
"0","  mutate(week = as.numeric(stringr::str_extract(week, ""\\d+""))) %>%"
"0","  group_by(week) %>%"
"0","  summarise("
"0","    mean_score = mean(score, na.rm = TRUE),"
"0","    sd_score   = sd(score,   na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  ) %>%"
"0","   mutate("
"0","    ymin = pmin(mean_score, 0),"
"0","    ymax = pmax(mean_score, 0)"
"0","  )"
"0",""
"0",""
"0","ggplot(df_weekly, aes(week, mean_score)) +"
"0","   geom_ribbon(aes(ymin = ymin, ymax = ymax),"
"0","              fill = ""#4575b4"", alpha = 0.15) +"
"0","   geom_line(color = ""#4575b4"", linewidth = 1) +"
"0","   geom_point(size = 3, color = ""#4575b4"") +"
"0","   geom_errorbar(aes(ymin = mean_score - sd_score, ymax = mean_score + sd_score),"
"0","                width = 0.3, color = ""gray50"") +"
"0","   geom_smooth(method = ""lm"", se = TRUE,"
"0","              color = ""#d73027"", fill = ""#f4a582"", linewidth = 1) +"
"0","   labs("
"0","    title = ""Average score across all students"","
"0","    subtitle = ""Average score (mean) ± SD; red line — linear trend"","
"0","    x = ""Week"","
"0","    y = ""Average score"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    panel.grid.minor = element_blank(),"
"0","    panel.grid.major.x = element_blank()"
"0","  )"
"0",""
