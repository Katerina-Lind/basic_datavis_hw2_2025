"0",""
"0","df_tm2 <- hogwarts %>%"
"0","  clean_names() %>%"
"0","  mutate("
"0","    house = fct_infreq(house),"
"0","    sex = factor(sex)"
"0","  ) %>%"
"0","  group_by(house, sex) %>%"
"0","  summarise("
"0","    n_students = n(),"
"0","    avg_result = mean(result, na.rm = TRUE),"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","ggplot(df_tm2, aes(area = n_students, fill = avg_result,"
"0","                   label = paste(sex, ""\n"", n_students))) +"
"0","  geom_treemap() +"
"0","  geom_treemap_text("
"0","    reflow = TRUE,"
"0","    place = ""centre"","
"0","    colour = ""white"","
"0","    size = 2.5,      "
"0","    grow = TRUE,"
"0","    min.size = 2.5,    "
"0","  ) +"
"0","  facet_wrap(~ house) +"
"0","  scale_fill_viridis_c(name = ""Average score"", option = ""C"") +"
"0","  labs("
"0","    title = ""Destribution of students by sex and house"","
"0","    subtitle = ""Area = number of students; color = average score across subjects"","
"0","    x = NULL, y = NULL"
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    panel.grid = element_blank(),"
"0","    strip.text = element_text(face = ""bold"", size = 11)"
"0","  )"
"0",""
