"0",""
"0","df_lollipop <- hogwarts %>%"
"0","  clean_names() %>%"
"0","  filter(course == 5) %>%"
"0","  mutate("
"0","    wand_core = fct_recode("
"0","      wand_core,"
"0","      ""Dragon heartstring"" = ""dragon heartstring"","
"0","      ""Phoenix feather""    = ""phoenix feather"","
"0","      ""Unicorn hair""       = ""unicorn hair"""
"0","    ),"
"0","    id = fct_reorder(as.factor(id), result, .desc = TRUE)"
"0","  )"
"0",""
"0",""
"0","mean_score <- mean(df_lollipop$result, na.rm = TRUE)"
"0","median_score <- median(df_lollipop$result, na.rm = TRUE)"
"0",""
"0","top5 <- df_lollipop %>%"
"0","  slice_max(order_by = result, n = 5)"
"0",""
"0","p <- ggplot(df_lollipop, aes(x = result, y = id, color = wand_core)) +"
"0","  geom_segment(aes(x = 0, xend = result, y = id, yend = id),"
"0","               linewidth = 0.6, color = ""grey70"") +"
"0","  geom_point(size = 3) +"
"0","   geom_vline(xintercept = mean_score, linetype = ""dashed"","
"0","             color = ""blue"", linewidth = 1) +"
"0","  annotate(""text"", x = mean_score, y = 3,"
"0","           label = paste0(""Mean = "", round(mean_score, 1)),"
"0","           color = ""blue"", size = 3.5, fontface = ""italic"", vjust = -1) +"
"0","    geom_vline(xintercept = median_score, linetype = ""dotted"","
"0","             color = ""purple"", linewidth = 1) +"
"0","  annotate(""text"", x = median_score, y = 8,"
"0","           label = paste0(""Median = "", round(median_score, 1)),"
"0","           color = ""purple"", size = 3.5, fontface = ""italic"", vjust = -1) +"
"0"," "
"0","  geom_text("
"0","    data = top5,"
"0","    aes(label = paste0(""ID "", id)),"
"0","    color = ""black"", size = 2.8, hjust = -0.1"
"0","  ) +"
"0","  scale_color_manual("
"0","    values = c("
"0","      ""Dragon heartstring"" = ""red"","
"0","      ""Phoenix feather""    = ""gold"","
"0","      ""Unicorn hair""       = ""grey50"""
"0","    ),"
"0","    name = ""Wand core"""
"0","  ) +"
"0","  labs("
"0","    title = ""Lollipop plot of total scores for 5th-year students"","
"0","    subtitle = ""Dashed line = mean; dotted line = median; color = wand core material"","
"0","    x = ""Total score for the year"","
"0","    y = ""Student ID"""
"0","  ) +"
"0","  theme_minimal(base_size = 12) +"
"0","  theme("
"0","    legend.position = ""top"","
"0","    panel.grid.major.y = element_blank(),"
"0","    axis.text.y = element_text(size = 7)"
"0","  )"
"0",""
"0","p"
"0",""
